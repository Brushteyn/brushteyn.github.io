(window.webpackJsonp=window.webpackJsonp||[]).push([[78],{549:function(t,e,o){},614:function(t,e,o){"use strict";o(549)},665:function(t,e,o){"use strict";o.r(e);var n=o(5),r=(o(36),o(54),o(12),{name:"TYandexMap",props:{coordinates:{type:Array,default:function(){return[]}},markIcon:{type:String,default:""}},data:function(){return{map:void 0,route:void 0,userCoords:[]}},watch:{coordinates:function(t){this.removePlot(),this.updateMarkers(t)}},mounted:function(){var t=this;window.ymaps&&this.$nextTick((function(){window.ymaps.ready(t.initMap)}))},methods:{initMap:function(){this.map=new window.ymaps.Map(this.$refs.mapEl,{center:this.coordinates,zoom:15,controls:[]},{suppressMapOpenBlock:!0}),this.mapControls(),this.updateMarkers(this.coordinates)},mapControls:function(){var t,e=this,o=window.ymaps.templateLayoutFactory.createClass('<div class="ymaps-controls"></div>',{build:function(){o.superclass.build.call(this),this.locationEl=document.querySelector(".button.contact__btn._contacts"),this.locationEl.addEventListener("click",this.getLocation)},clear:function(){this.locationEl&&this.locationEl.removeEventListener("click",this.getLocation),o.superclass.clear.call(this)},getLocation:(t=Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.plotRoute();case 2:case"end":return t.stop()}}),t)}))),function(){return t.apply(this,arguments)})}),r=new window.ymaps.control.Button({options:{layout:o}});this.map.controls.add(r)},placemark:function(t){return new window.ymaps.Placemark(t,{},{iconLayout:"default#image",iconImageHref:"/svg/map_logo.svg",iconImageSize:[100,108],iconImageOffset:[-50,-108]})},removePlot:function(){this.route&&this.map.geoObjects.remove(this.route),this.route=null,this.map.geoObjects.each((function(marker){marker.properties.set("plot",!1)}))},plotRoute:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.route){e.next=4;break}t.removePlot(),e.next=9;break;case 4:return e.next=6,t.getUserPosition();case 6:t.route=new window.ymaps.multiRouter.MultiRoute({referencePoints:[t.userCoords,t.coordinates],params:{results:1}},{wayPointVisible:!1,boundsAutoApply:!0,routeActiveStrokeColor:"004D47"}),t.map.geoObjects.add(t.route),t.route.events.once("update",(function(){console.log(t.map.geoObjects),t.map.geoObjects.each((function(marker){marker.properties.set("plot",!0)}))}));case 9:case"end":return e.stop()}}),e)})))()},getUserPosition:function(){var t=this;return new Promise((function(e,o){if(t.userCoords.length)return e(t.userCoords);window.ymaps.geolocation.get({provider:"browser"}).then((function(o){return t.userCoords=o.geoObjects.get(0).geometry._coordinates,e(t.userCoords)})).catch((function(o){window.ymaps.geolocation.get({provider:"yandex"}).then((function(o){return t.userCoords=o.geoObjects.get(0).geometry._coordinates,e(t.userCoords)})).catch((function(t){return console.error("Не могу определить ваше местоположение.")}))}))}))},updateMarkers:function(t){this.map.geoObjects.removeAll(),this.map.geoObjects.add(this.placemark(t))}}}),c=r,l=(o(614),o(51)),component=Object(l.a)(c,(function(){return(0,this._self._c)("div",{ref:"mapEl",staticClass:"map"},[this._t("default")],2)}),[],!1,null,null,null);e.default=component.exports}}]);